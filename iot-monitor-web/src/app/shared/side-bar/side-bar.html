<mat-sidenav-container class="h-screen w-screen">
  <mat-sidenav
    [mode]="drawerMode()"
    [(opened)]="isDrawerOpen"
    class="w-72 bg-blue-800 text-white shadow-lg"
  >
    <div class="flex items-center justify-between p-4 border-b border-blue-700">
      <h2 class="text-lg font-bold">IoT Devices</h2>
      <!-- Cerrar en mobile -->
      <button mat-icon-button class="md:hidden" (click)="isDrawerOpen = false">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <!--Lista de dispositivos-->
    @if(devicesResource.hasValue()){
    <div class="flex flex-col h-full space-y-2 p-2">
      @for(device of devicesResource.value()!; track device.id){
      <a
        mat-list-item
        (click)="selectDevice(device)"
        [routerLink]="['device-metric', device.id]"
        routerLinkActive="bg-blue-700 text-white"
        class="flex items-center justify-start gap-3 p-3 rounded-lg hover:bg-blue-700 hover:text-white transition shadow-sm hover:shadow-md cursor-pointer"
      >
        <mat-icon matListItemIcon>memory</mat-icon>
        <div class="flex flex-col">
          <span matLine class="font-medium">{{ device.name }}</span>
          <span matLine class="text-xs text-gray-400">
            {{ device.serialNumber }}
          </span>
        </div>
      </a>
      } @empty {
      <div class="flex justify-center p-4">
        <span class="text-gray-400">No hay dispositivos</span>
      </div>
      }
    </div>
    }@else if(devicesResource.isLoading()){
    <div class="flex justify-center p-4">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
    }
  </mat-sidenav>

  <mat-sidenav-content class="flex flex-col h-screen">
    <!-- Navbar / Topbar -->
    <header class="flex items-center justify-between bg-white shadow px-4 py-3">
      <!-- Botón menu en mobile -->
      <button mat-icon-button class="md:hidden" (click)="isDrawerOpen = true">
        <mat-icon>menu</mat-icon>
      </button>

      <h1 class="text-xl font-bold text-gray-800">IoT Monitor</h1>

      <!-- Info adicional, solo visible en md+ -->
      <div class="flex items-center space-x-4">
        <span class="text-gray-500">Bienvenido, {{ authData.user()?.fullName }}</span>
        <button mat-stroked-button color="warn" class="text-sm" (click)="logout()">
          Cerrar sesión
        </button>
      </div>
    </header>

    <!-- Main content -->
    <div class="flex-1 p-6 bg-gray-100 flex flex-col h-screen">
      <main class="flex-1 p-6 bg-gray-100">
        <h1 class="text-2xl font-bold mb-6 items-center justify-center text-gray-800">Dashboard</h1>
        <router-outlet></router-outlet>
      </main>
    </div>
  </mat-sidenav-content>
</mat-sidenav-container>
